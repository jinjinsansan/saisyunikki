# さくらのサーバー用 .htaccess設定

# CORS設定
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type, Authorization"

# PHPエラー表示設定（本番環境では無効にする）
php_flag display_errors Off
php_flag log_errors On

# セキュリティヘッダー
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"

# ファイルアップロード制限
php_value upload_max_filesize 10M
php_value post_max_size 10M

# セッション設定
php_value session.cookie_httponly 1
php_value session.cookie_secure 1

# 機密ファイルへのアクセス拒否
<Files "*.sql">
    Order allow,deny
    Deny from all
</Files>

<Files "config.php">
    Order allow,deny
    Deny from all
</Files>

# APIルーティング
RewriteEngine On
RewriteBase /api/

# 存在しないファイルの場合は404を返す
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . - [R=404,L]